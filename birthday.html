<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Happy Birthday Gayatri!</title>
<style>
:root{
  --text:#b85c5c;
  --accent:#c78686;
}
html,body{
  height:100%; margin:0; padding:0;
  background: linear-gradient(160deg, #fff1f0, #ffe8e0);
  font-family: 'Georgia', serif;
  color:#333;
  overflow-x:hidden;
}
.wrap{
  min-height:100%; display:flex; flex-direction:column;
  align-items:center; justify-content:flex-start;
  padding:20px 6vw 40px 6vw;
  box-sizing:border-box;
}
h1#greeting{
  font-size:8vw; margin:20px 0 10px;
  color:var(--text); line-height:1.1; text-align:center;
}
.message{font-size:4vw;margin:6px 0 12px;color:#555;text-align:center;}

/* Cake */
.cake-container{
  position: relative; font-size:20vw; margin:16px 0; cursor:pointer;
  user-select:none;
}
.candle{
  position: absolute; top:0; width:10%; height:25%; background:#ffd740;
  border-radius:2px;
}
.flame{
  position: absolute; top:-15%; left:50%; transform: translateX(-50%);
  width:50%; height:50%;
  background: radial-gradient(circle at 50% 50%, #ffeb3b 0%, #ff9800 60%, transparent 100%);
  border-radius:50%; animation: flicker 0.5s infinite alternate;
}
@keyframes flicker{
  0% { transform: translateX(-50%) scaleY(1); opacity:1;}
  50%{ transform: translateX(-50%) scaleY(0.8); opacity:0.8;}
  100%{ transform: translateX(-50%) scaleY(1); opacity:1;}
}
.smoke{
  position:absolute; top:-15%; left:50%; transform:translateX(-50%);
  width:20%; height:20%; background: radial-gradient(circle, rgba(200,200,200,0.6) 0%, transparent 70%);
  border-radius:50%; opacity:0; pointer-events:none;
  animation: rise 1s ease-out forwards;
}
@keyframes rise{
  0% { transform: translateX(-50%) translateY(0) scale(0.3); opacity:0.7;}
  100% { transform: translateX(-50%) translateY(-60%) scale(1); opacity:0;}
}

/* Envelope */
.envelope{
  position:relative; width:84%; max-width:400px; height:var(--env-height,180px);
  margin:16px auto 6px auto; background:#d9a5a5; border-radius:10px;
  box-shadow:0 6px 14px rgba(0,0,0,0.12); overflow:visible; cursor:pointer;
}
:root{--env-height:clamp(140px,38vw,220px);}
.flap{
  position:absolute; left:0; top:-1px; width:100%; height:46%;
  background:var(--accent); clip-path:polygon(50% 0, 0 100%, 100% 100%);
  transform-origin:center top; transition:transform .7s ease;
}
.letter{
  position:absolute; left:0; bottom:-150%; width:100%; height:auto;
  background:#fffaf8; color:#333; padding:16px 18px; box-sizing:border-box;
  border-radius:6px; transition:bottom .7s ease, opacity .7s ease;
  overflow:auto; max-height:58vh; font-size:4vw; line-height:1.4; opacity:0;
}
.envelope.open .flap{transform:rotateX(180deg);}
.envelope.open .letter{bottom:4px; opacity:1;}
.tap-text{font-size:3.5vw;color:#555;margin-top:8px;font-style:italic;text-align:center;}

/* Sparkles */
.sparkle-container {position: absolute; top:0; left:0; width:100%; height:100%; pointer-events:none; overflow:hidden; z-index:1;}
.sparkle{position:absolute; border-radius:50%; opacity:0.8;
  background: radial-gradient(circle, #ffd6a5, #fff1f0); animation: floatSparkle 6s linear infinite;
}
@keyframes floatSparkle{
  0% { transform: translateY(0) scale(0.8); opacity:0.8; }
  50% { transform: translateY(-60px) scale(1.2); opacity:0.4; }
  100% { transform: translateY(0) scale(0.8); opacity:0.8; }
}

#confettiCanvas{position:fixed; left:0; top:0; width:100vw; height:100vh; z-index:0; pointer-events:none;}
</style>
</head>
<body>
<canvas id="confettiCanvas" aria-hidden="true"></canvas>
<div class="wrap" role="main">
  <h1 id="greeting">ðŸŽ‚ Happy Birthday, Gayatri! ðŸŽ‰</h1>
  <p class="message">Tap the envelope to open your special letter ðŸ’Œ</p>

  <!-- Cake with blowable candles -->
  <div class="cake-container" id="cake">
    ðŸŽ‚
    <div class="candle" style="left:20%;"><div class="flame"></div><div class="smoke"></div></div>
    <div class="candle" style="left:45%;"><div class="flame"></div><div class="smoke"></div></div>
    <div class="candle" style="left:70%;"><div class="flame"></div><div class="smoke"></div></div>
  </div>
  <p style="font-size:4vw;color:#b85c5c;text-align:center;margin-top:12px;">Blow to extinguish candles!</p>

  <!-- Envelope -->
  <div class="envelope" id="envelope" role="button" tabindex="0">
    <div class="flap"></div>
    <div class="letter">
      <p>Dear Gayatri,</p>
      <p>Happy Birthday to the star of the day! ðŸŒ¸âœ¨</p>
      <p>May this year bring you endless happiness, laughter, and love. ðŸ’–</p>
      <p>You are special, cherished, and loved more than words can say. ðŸŽ‚ðŸŽ‰</p>
      <p>With lots of love and warm wishes, ðŸ’•</p>
      <p><strong>Happy Birthday, Gayatri! ðŸŽ‚ðŸŽˆ</strong></p>
      <br>
      <p><em>PS: Sorry for not adding more features. This is the best I can do in 1 hour ðŸ™ƒ</em></p>
    </div>
  </div>
  <p class="tap-text">ðŸ“© Tap the envelope to open/close</p>

  <div class="sparkle-container"></div>
</div>

<script>
// ---------- Confetti ----------
const canvas=document.getElementById('confettiCanvas'),ctx=canvas.getContext('2d');
function resizeCanvas(){canvas.width=window.innerWidth;canvas.height=window.innerHeight;}
window.addEventListener('resize',resizeCanvas,{passive:true});resizeCanvas();
let confetti=[];function rand(min,max){return Math.random()*(max-min)+min;}
function randomColor(){const c=["#b85c5c","#c78686","#d9a5a5","#f2d4d4"];return c[Math.floor(Math.random()*c.length)];}
function addConfetti(n){const max=Math.min(120,Math.max(40,Math.floor(window.innerWidth/6)));for(let i=0;i<(n||Math.floor(max*0.6));i++){confetti.push({x:rand(0,canvas.width),y:rand(-canvas.height,0),r:rand(3,7),d:rand(2,6),color:randomColor(),tilt:rand(-0.5,0.5)})}}
function drawConfetti(){ctx.clearRect(0,0,canvas.width,canvas.height);for(let i=0;i<confetti.length;i++){const c=confetti[i];ctx.beginPath();ctx.fillStyle=c.color;ctx.ellipse(c.x,c.y,c.r*1.1,c.r,0,0,Math.PI*2);ctx.fill();c.y+=c.d;c.x+=Math.sin(c.tilt*i)*0.5;c.tilt+=0.01;if(c.y>canvas.height+20){c.y=rand(-canvas.height,-10);c.x=rand(0,canvas.width);}}if(confetti.length>300)confetti.splice(0,confetti.length-300);requestAnimationFrame(drawConfetti);}
addConfetti();drawConfetti();

// ---------- Sparkles ----------
const sparkleContainer=document.querySelector('.sparkle-container');
for(let i=0;i<25;i++){const s=document.createElement('div');s.classList.add('sparkle');s.style.left=`${Math.random()*100}%`;s.style.top=`${Math.random()*100}%`;s.style.animationDuration=`${4+Math.random()*3}s`;let sz=3+Math.random()*4;s.style.width=`${sz}px`;s.style.height=`${sz}px`;sparkleContainer.appendChild(s);}

// ---------- Envelope toggle ----------
const envelope=document.getElementById('envelope');
envelope.addEventListener('click',()=>{envelope.classList.toggle('open');});
envelope.addEventListener('keydown',(e)=>{if(e.key==='Enter'||e.key===' '){e.preventDefault();envelope.classList.toggle('open');}});

// ---------- Blowable candles with smoke ----------
const cake=document.getElementById('cake');
const candles=Array.from(cake.querySelectorAll('.candle'));
candles.forEach(c=>{c.querySelector('.flame').dataset.lit='true';});

navigator.mediaDevices.getUserMedia({ audio: true }).then(stream => {
  const audioCtx = new AudioContext();
  const source = audioCtx.createMediaStreamSource(stream);
  const analyser = audioCtx.createAnalyser();
  analyser.fftSize = 256;
  source.connect(analyser);
  const dataArray = new Uint8Array(analyser.frequencyBinCount);
  function detectBlow(){
    analyser.getByteFrequencyData(dataArray);
    const volume = dataArray.reduce((a,b)=>a+b)/dataArray.length;
    if(volume>15){
      candles.forEach(c=>{
        const flame = c.querySelector('.flame');
        const smoke = c.querySelector('.smoke');
        if(flame.dataset.lit==='true'){
          flame.style.opacity=0;
          flame.dataset.lit='false';
          smoke.style.opacity=1;
          setTimeout(()=>smoke.style.opacity=0,800);
        }
      });
    }
    requestAnimationFrame(detectBlow);
  }
  detectBlow();
}).catch(e=>console.warn("Microphone access denied", e));

cake.addEventListener('click',()=>{
  candles.forEach(c=>{
    const flame = c.querySelector('.flame');
    flame.style.opacity=1;
    flame.dataset.lit='true';
  });
});
</script>
</body>
</html>